#!/usr/bin/bash

cd "$(dirname "$0")"

preset=default
build=1

for ARG in $(getopt -l clean,debug,build,help,no-build -o 'cdbh' -- "$@"); do
    case "$ARG" in
        --clean|-c) rm -rf build build-debug ;;
        --debug|-d) preset=debug ;;
        --build|-b) build=1 ;;
        --no-build) build=0 ;;
        --help|-h) echo "Usage: $0 [--clean] [--debug] [--build|--no-build] [--help]"; exit 0 ;;
        --) break;;
        *) echo "Unknown option: $ARG"; exit 1 ;;
    esac
done

cmake --preset ${preset} -Wno-dev --fresh
if [ ${build} -eq 1 ]; then
    cmake --build . --preset ${preset}
fi
